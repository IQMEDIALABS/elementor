(a=>{class b{constructor(b,c){this.settings=a.extend(!0,this.getDefaultSettings(),c),this.$container=a(b),this.initElements(),this.runGallery(),this.bindEvents()}getDefaultSettings(){return{classes:{container:"gallery-container",item:"gallery-item",image:"gallery-image",firstRowItem:"gallery-"},columns:4,horizontalGap:10,verticalGap:10,idealRowHeight:250,lastRow:"baby"}}initElements(){this.$container.addClass(this.settings.classes.container)}bindEvents(){}createItem(b){const c=a("<div>",{class:this.settings.classes.item}),d=a("<div>",{class:this.settings.classes.image}).css("background-image","url("+b.thumbnail+")");return c.append(d),c}buildGallery(){const a=this.settings.items;this.$items=jQuery(),a.forEach(a=>{const b=this.createItem(a);this.$items=this.$items.add(b),this.$container.append(b)})}runGallery(){this.buildGallery();const a=[];this.imagesData=[],jQuery.each(this.settings.items,b=>{const c=new Image,d=new Promise(a=>{c.onload=a});a.push(d),d.then(()=>this.calculateImageSize(c,b)),c.src=this.settings.items[b].thumbnail}),Promise.all(a).then(()=>this.run())}calculateImageSize(a,b){this.imagesData[b]={width:a.width,height:a.height,ratio:a.width/a.height}}run(){this.makeJustifiedRow(0,this.$container.width()),this.$container[0].style.setProperty("--hgap",this.settings.horizontalGap+"px")}makeJustifiedRow(a,b){let c=0;for(let d,e=a;;e++){d=Math.round(this.settings.idealRowHeight*this.imagesData[e].ratio);const f=c+d;if(f>b){const d=b-c;if(d<f-b){this.fitImagesInContainer(a,e,c),this.makeJustifiedRow(e,b);break}}const g=e===this.settings.items.length-1;if(this.imagesData[e].computedWidth=d,g){if("hide"!==this.settings.lastRow){const c="fit"===this.settings.lastRow?f:b;this.fitImagesInContainer(a,e,c)}break}c=f}}fitImagesInContainer(a,b,c){for(let d=a;d<=b;d++){const e=this.imagesData[d],f=Math.round(1e4*(e.computedWidth/c))/1e4,g=this.$items.get(d);if(g.style.setProperty("--item-width",f),g.style.setProperty("--gap-count",b-a-1),d===a){g.style.marginLeft=0;const a=g.querySelectorAll("."+this.settings.classes.image)[0];a.style.paddingBottom=100*(e.height/e.width)+"%",a.style.height="initial"}}}unbindEvents(){}destroy(){unbindEvents()}}a.fn.gallery=function(c){return this.each(function(){const d=a(this);if(!("string"==typeof c))return void d.data("gallery",new b(this,c));const e=d.data("gallery");if(!e)throw Error("Trying to perform the `"+c+"` method prior to initialization");if(!e[c])throw ReferenceError("Method `"+c+"` not found in gallery instance");e[c].apply(e,Array.prototype.slice.call(arguments,1)),"destroy"===c&&d.removeData("gallery")}),this},window.Gallery=b})(jQuery);