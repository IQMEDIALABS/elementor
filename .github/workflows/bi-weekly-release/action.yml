name: Bi Weekley Release
description: Count the number of days since the last automatic release and set it as an environment variable.
inputs:
  CHANNEL:
    required: true
    description: "The channel to get the version to (cloud, CCU)."
  LAST_AUTOMATED_RELEASE:
    required: false
    description: "The date of the last release."

runs:
  using: "composite"
  steps:
    - shell: bash
      run: |
        LAST_AUTOMATED_RELEASE=${{ inputs.LAST_AUTOMATED_RELEASE }}
        echo "LAST_AUTOMATED_RELEASE=${{ inputs.LAST_AUTOMATED_RELEASE }}" >> $GITHUB_ENV
#        last_release=$(git ls-remote --tags | grep -v "\-rc" | grep -v "refs/tags/v" | grep "cloud" | tail -n1 | awk ‘{print $2}’)
        current_date=$(date +%s)
        release_date=$(git log -1 --format=%ct LAST_AUTOMATED_RELEASE)
        time_diff=$(( (current_date - LAST_AUTOMATED_RELEASE) / (60*60*24) ))
        if [ "$time_diff" -ge 14 ]; then
          echo "14 days have passed since the release."
          # Perform additional actions here
        else
          echo "Less than 14 days have passed since the release."
        fi
